<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="PerspicuOS : Nested Kernel Prototype for AMD64 Architecture">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>PerspicuOS</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/nestedkernel/PerspicuOS">View on GitHub</a>

          <h1 id="project_title">PerspicuOS</h1>
          <h2 id="project_tagline">Nested Kernel Prototype for AMD64 Architecture</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/nestedkernel/PerspicuOS/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/nestedkernel/PerspicuOS/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h3>
<a id="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"
    aria-hidden="true"><span class="octicon octicon-link"></span></a>Welcome to
PerspicuOS.</h3>

<p>

    PerspicuOS is a prototype operating system that realizes the <a
        href="nestedkernel.org">Nested Kernel</a>, a new operating architecture
    that restricts access to a device's memory management unit so that it can
    then perform memory isolation within the kernel. The key challenge that
    PerspicuOS addresses is how to virtualize the MMU on real hardware, AMD64,
    in a real operating system, FreeBSD 9.0, while not assuming any hardware
    privilege separation or kernel integrity properties such as control flow
    integrity. PerspicuOS presents a technique that allows both trusted and
    untrusted code to operate at the same hardware privilege level, thereby
    virtualizing Ring 0 supervisor privilege.  

</p>

<p>

    PerspicuOS does this by virtualizing the MMU, which requires memory
    protections for Page Tables and CPU protections for control register
    isolation. PerspicuOS protects the page tables by intializing all mappings
    in the system so that Page Table Pages are mapped as read-only, and then
    introduces a technique that we call de-privileging to ensure those
    privileges are never bypassed at runtime. PerspicuOS de-previleges the
    untrusted portion of the kernel by removing all MMU modifying instructions
    from the untrusted code's source, which statically reduces its privilege.
    Then PerspicuOS enforces lifetime kernel code integrity (mapping all code
    pages as read-only), denies execution of kernel data (using no-execute
    hardware), and denies execution of user mode code and data pages while in
    supervisor mode (using supervisor mode execution prevention).

</p>

<p>

    By design PerspicuOS defends against a large class of attacks in code
    injection because of it's code integrity properties.  We also use
    PerspicuOS to explore protection of the system call vector table, recording
    modifications of the allproc processor list data structure, and to invoke a
    security monitor that records audit records to a protected log. For more
    details on the design of PerspicuOS please read our recent ASPLOS
    publication <a
        href="http://nathandautenhahn.com/downloads/publications/asplos200-dautenhahn.pdf">here</a>.
    
</p>
    
</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>
    PerspicuOS has several contributors: Nathan Dautenhahn, Theodoras
    Kasampalis, Will Dietz, John Criswell, and Vikram Adve. This work was
    accomplished while working at the University of Illinois at
    Urbana-Champaign in the LLVM research group under the supervision of Vikram
    Adve. 
</p>
<!--
<p>You can <a href="https://github.com/blog/821" class="user-mention">@mention</a> a GitHub username to generate a link to their profile. The resulting <code>&lt;a&gt;</code> element will link to the contributor's GitHub Profile. For example: In 2007, Chris Wanstrath (<a href="https://github.com/defunkt" class="user-mention">@defunkt</a>), PJ Hyett (<a href="https://github.com/pjhyett" class="user-mention">@pjhyett</a>), and Tom Preston-Werner (<a href="https://github.com/mojombo" class="user-mention">@mojombo</a>) founded GitHub.</p>
-->

<h3>
<a id="build-instructions" class="anchor" href="#build-instructions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build Instructions</h3>

<p>Our current nested kernel implementation for x86-64 FreeBSD is called
PerspicuOS.</p>

<ol>
<li>Install FreeBSD 9.0:
<a href="http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/amd64/ISO-IMAGES/9.0/">http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/amd64/ISO-IMAGES/9.0/</a>
</li>
<li>In FreeBSD 9.0 System, obtain the repo:
  <a href="https://github.com/nestedkernel/PerspicuOS">PerspicuOS on GitHub</a>
<li>Build the nested kernel (assumes clang is in /usr/bin/clang)
<br/>
$ cd REPO_DIR/nk
<br/>
$ make
</li>
<li>Configure FreeBSD /etc/src.conf
<br/>
# This setting to build world without -Werror:
<br/>
NO_WERROR=
<br/>
# This setting to build kernel without -Werror:
<br/>
WERROR=
<br/>
# Configure the system to use clang
<br/>
CC=/PATH/TO/CLANG
<br/>
CXX=/PATH/TO/CLANG
<br/>
CPP=/PATH/TO/CLANG
<br/>
# Export the nested kernel library directory for the linker script in FreeBSD. 
<br/>
NK_HOME=/PATH/TO/REPO_DIR
<br/>
# Set the library path to the nested kernel lib
<br/>
CFLAGS+=-I/PATH/TO/REPO_DIR/nk/include</li>
<li>Make PerspicuOS using FreeBSD building process selecting the NK kernel
configuration.</li>
<li>Install and Boot (you can use either the base harddrive or
    a VM tool Like Qemu, VirtualBox, or VMWare)</li>
</ol>

<br/>
We have a tool that automates the kernel compile and install process in
"REPO_DIR/scripts/compile_install_test_sva.rb". You can use this, but make sure
to read the code to understand how it operates.

<h3>
  <a id="comment-on-code" class="anchor" href="#comment-on-code" aria-hidden="true">
  <span class="octicon octicon-link"></span></a>Comment on PerspicuOS Repo</h3>
  <p>
    PerspicuOS was derived from a few other research projects and as such reflects 
    an odd arangement of naming conventions and unused functionality. The 
    nested kernel shared a similar interface as previous work using the SVA compiler 
    based virtual machine (<a href="https://github.com/jtcriswell/SVA">SVA Github</a>), 
    but only includes a small subset of the entire interface, namely the MMU,
    and modifies the functionality of the internal policies for page-translation updates.
  </p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>Having trouble with PerspicuOS? We are currently setting up a suitable
method for contact. Otherwise, submit a pull request to start some code
specific dialog.</p>


      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">PerspicuOS maintained by <a href="https://github.com/nestedkernel">nestedkernel</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
